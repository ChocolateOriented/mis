<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mo9.risk.modules.dunning.dao.SMisDunningProductivePowerDailyReportDao">
    
	<sql id="sMisDunningProductivePowerDailyReportColumns">
		a.id AS "id",
		a.createtime AS "createTime",
		a.dunningpeoplename AS "dunningPeopleName",
		a.dunningcycle AS "dunningCycle",
		a.taskcycle AS "taskCycle",
		a.totaluser AS "totalUser",
		a.amount AS "overdueAmount",
		a.corpusamount AS "corpusAmount",
		a.dealuser AS "dealUser",
		a.dealnumber AS "dealNumber",
		a.effectiveuser AS "effectiveUser",
		a.ptpuser AS "ptpUser",
		a.ptpamount AS "ptpAmount",
		a.ptpcorpusamount AS "ptpCorpusAmount",
		a.effectiveuserpercent AS "effectiveUserPercent",
		a.effectiveamountpercent AS "effectiveAmountPercent",
		a.effectivecorpusamountpercent AS "effectiveCorpusAmountPercent",
		a.ptpuserpercent AS "ptpUserPercent",
		a.ptpamountpercent AS "ptpAmountPercent",
		a.ptpcorpusamountperent AS "ptpCorpusAmountPerent",
		a.payoffuser AS "payoffUser",
		a.payoffcorpusamount AS "payoffCorpusAmount",
		a.payoffamount AS "payoffAmount",
		a.groupId AS "groupId"
	</sql>
	
	<sql id="sMisDunningProductivePowerDailyReportJoins">
	</sql>
	
	<select id="findList" resultType="SMisDunningProductivePowerDailyReport">
		SELECT 
			<include refid="sMisDunningProductivePowerDailyReportColumns"/>
		FROM s_mis_dunning_productive_power_daily_report a
		<include refid="sMisDunningProductivePowerDailyReportJoins"/>
		<where>
			<if test="beginCreateTime != null and endCreateTime != null and beginCreateTime != '' and endCreateTime != ''">
				AND a.createtime BETWEEN #{beginCreateTime} AND #{endCreateTime}
			</if>
			<if test="taskCycle != null and taskCycle != ''">
				AND a.taskCycle = #{taskCycle}
			</if>
			<if test="groupId != null and groupId != ''">
				AND a.groupId = #{groupId}
			</if>
			<if test="queryGroups != null and queryGroups.size > 0">
				AND a.groupId in
				<foreach item="item" index="index" collection="queryGroups" open="(" separator="," close=")">
		            #{item.id}
		        </foreach>
			</if>
			<if test="dunningPeopleName != null and dunningPeopleName != ''">
				AND a.dunningPeopleName LIKE concat('%',#{dunningPeopleName},'%')
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
			</otherwise>
		</choose>
	</select>
</mapper>